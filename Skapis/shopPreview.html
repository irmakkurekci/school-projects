<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Shop Preview - Skapis</title>
  <link rel="stylesheet" href="styles2.css">
  <style>
    .shop-container {
      padding: 40px;
      max-width: 1000px;
      margin: 30px auto;
    }

    .shop-title {
      font-size: 28px;
      color: #fc6601;
      margin-bottom: 20px;
      text-align: center;
    }

    .products {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }

    .product-card {
      width: 220px;
      padding: 15px;
      border: 1px solid #ccc;
      border-radius: 8px;
      background-color: #fff5f9;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .product-card p {
      margin: 5px 0;
      font-size: 14px;
    }

    .product-card button {
      margin-top: 10px;
      padding: 6px 10px;
      background-color: #ff1493;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .product-card button:hover {
      background-color: #e01183;
    }

    .add-form {
      margin-top: 40px;
      padding: 20px;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }

    .add-form h3 {
      color: #ff1493;
    }

    .add-form input,
    .add-form textarea {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      border-radius: 6px;
      border: 1px solid #ccc;
    }

    .add-form button {
      padding: 10px 20px;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    /* Header layout */
    .brand-wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .logo {
      width: 70px;
      height: 70px;
      object-fit: contain;
      margin-bottom: 5px;
    }

    .company-name {
      font-size: 28px;
      font-weight: bold;
      margin: 0;
    }

    .company-name a {
      text-decoration: none;
      color: #ff1493;
    }

    input[type="search"] {
      width: 200px;
      height: 35px;
      padding: 6px 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 14px;
    }

    .dropdown {
      position: relative;
      display: inline-block;
    }

    .dropdown-content {
      display: none;
      position: absolute;
      right: 0;
      background-color: white;
      min-width: 160px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      border-radius: 5px;
      z-index: 10;
    }

    .dropdown-content a {
      display: block;
      padding: 10px 15px;
      text-decoration: none;
      color: #ff1493;
    }

    .dropdown-content a:hover {
      background-color: #ffe0ec;
    }

    .dropdown:hover .dropdown-content {
      display: block;
    }
  </style>
</head>
<body>

<!-- Header Section -->
<div class="header-section">
	<header style="display: flex; align-items: center; justify-content: space-between; padding: 1px 2px; border-bottom: 2px solid #FE7D6A60;">
		<div style="display: flex; flex-direction: column; align-items: center;">
		  <img src="logo.png" alt="Skapis Logo" class="logo" style="width: 90px; height: 70px; object-fit: contain;">
		  <h1 class="company-name" style="margin: 0px 0 0 0; font-size: 35px;">
			<a href="index.html" style="text-decoration: none; color: #FF1493; ">Skapis</a>
		  </h1>
		</div>
		<input type="search" placeholder="Search...">
		
	  <button onclick="location.href='newpage.html'" style="background: none; border: none; cursor: pointer;">
		<div class="dropdown">
			<img src="icon.png" alt="User Icon" style="width: 40px; height: 40px;">
			<div class="dropdown-content">
				<a href="shopPreview.html">Add Product</a>
				<a href="messages.html">Messages</a>
				<a href="wallet.html">Wallet</a>
				<a href="rating.html">Rating and Comments</a>

			</div>
		</div>
	  </button>
	</header>
</div>

<!-- Shop Content -->
<div class="shop-container">
  <h2 class="shop-title" id="shopTitle">TheShop by irmakk13</h2>

  <div class="products" id="productList">
    <!-- Products will be injected here -->
  </div>

<div class="add-form">
  <h3>Add a New Product</h3>
  <input type="text" id="productBrand" placeholder="Brand">
  <input type="text" id="productTitle" placeholder="Product Title">
  <textarea id="productDescription" placeholder="Description"></textarea>
  <input type="text" id="productPrice" placeholder="Price (e.g., $25)">
  <input type="file" id="productImage" accept="image/*">
  <button onclick="addProduct()">Add Product</button>
</div>


<script>
  const shopName = localStorage.getItem('shopName') || "TheShop";
  const accountName = localStorage.getItem('accountName') || "irmakk13";
  document.getElementById("shopTitle").innerText = `${shopName} by ${accountName}`;

  let products = JSON.parse(localStorage.getItem("shopProducts")) || [];

 function renderProducts() {
  const productList = document.getElementById("productList");
  productList.innerHTML = "";

  products.forEach((p, index) => {
    const div = document.createElement("div");
    div.className = "product-card";
    div.innerHTML = `
      <img src="${p.image}" alt="Product Image" style="width:100%; height:150px; object-fit: cover; border-radius: 6px; margin-bottom: 10px;">
      <p><strong>Brand:</strong> ${p.brand}</p>
      <p><strong>Title:</strong> ${p.title}</p>
      <p><strong>Description:</strong> ${p.description}</p>
      <p><strong>Price:</strong> ${p.price}</p>
      <button onclick="deleteProduct(${index})">Delete</button>
      <button onclick="editProduct(${index})" style="margin-left: 10px; background-color:#ffc107; color: black;">Edit</button>
    `;
    productList.appendChild(div);
  });

  localStorage.setItem("shopProducts", JSON.stringify(products));
}


function addProduct() {
  const brand = document.getElementById("productBrand").value.trim();
  const title = document.getElementById("productTitle").value.trim();
  const description = document.getElementById("productDescription").value.trim();
  const price = document.getElementById("productPrice").value.trim();
  const imageInput = document.getElementById("productImage");
  const file = imageInput.files[0];

  if (!brand || !title || !description || !price || !file) {
    alert("Please fill in all product fields and choose an image.");
    return;
  }

  const reader = new FileReader();
  reader.onload = function (e) {
    const image = e.target.result;

    products.push({ brand, title, description, price, image });

    // Reset form
    document.getElementById("productBrand").value = '';
    document.getElementById("productTitle").value = '';
    document.getElementById("productDescription").value = '';
    document.getElementById("productPrice").value = '';
    document.getElementById("productImage").value = '';

    renderProducts();
  };
  reader.readAsDataURL(file);
}

  function deleteProduct(index) {
    if (confirm("Are you sure you want to delete this product?")) {
      products.splice(index, 1);
      renderProducts();
    }
  }

  window.onload = renderProducts;
  
function editProduct(index) {
  const product = products[index];
  document.getElementById("productBrand").value = product.brand;
  document.getElementById("productTitle").value = product.title;
  document.getElementById("productDescription").value = product.description;
  document.getElementById("productPrice").value = product.price;

  // Set edit mode
  document.getElementById("productImage").value = ''; // image must be re-selected if changed
  document.querySelector(".add-form button").textContent = "Save Changes";

  // Remove old event listener if any
  const newButton = document.querySelector(".add-form button");
  const clone = newButton.cloneNode(true);
  newButton.parentNode.replaceChild(clone, newButton);

  clone.addEventListener("click", function () {
    const updatedBrand = document.getElementById("productBrand").value.trim();
    const updatedTitle = document.getElementById("productTitle").value.trim();
    const updatedDescription = document.getElementById("productDescription").value.trim();
    const updatedPrice = document.getElementById("productPrice").value.trim();
    const imageFile = document.getElementById("productImage").files[0];

    if (!updatedBrand || !updatedTitle || !updatedDescription || !updatedPrice) {
      alert("Please fill all fields.");
      return;
    }

    const updateAndRender = (imageBase64) => {
      products[index] = {
        brand: updatedBrand,
        title: updatedTitle,
        description: updatedDescription,
        price: updatedPrice,
        image: imageBase64 || product.image // use new or existing image
      };

      // Reset form
      document.getElementById("productBrand").value = '';
      document.getElementById("productTitle").value = '';
      document.getElementById("productDescription").value = '';
      document.getElementById("productPrice").value = '';
      document.getElementById("productImage").value = '';
      document.querySelector(".add-form button").textContent = "Add Product";

      renderProducts();
    };

    if (imageFile) {
      const reader = new FileReader();
      reader.onload = function (e) {
        updateAndRender(e.target.result);
      };
      reader.readAsDataURL(imageFile);
    } else {
      updateAndRender();
    }
  });
}



 
</script>

</body>
</html>
